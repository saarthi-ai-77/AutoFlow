import { Server } from 'socket.io';
declare class WebSocketSecurityService {
    private io;
    private connectedUsers;
    private connectionRateLimits;
    private messageRateLimits;
    private heartbeatInterval;
    private readonly maxConnectionsPerIP;
    private readonly maxConnectionsPerUser;
    private readonly connectionRateLimitWindow;
    private readonly messageRateLimitWindow;
    private readonly maxMessagesPerWindow;
    private readonly heartbeatIntervalMs;
    private readonly connectionTimeoutMs;
    initialize(io: Server): void;
    private authenticateSocket;
    private handleSecureConnection;
    private setupSecureEventHandlers;
    private checkWorkflowAccess;
    private checkExecutionAccess;
    private isRateLimited;
    private recordConnection;
    private getIPConnectionCount;
    private getUserConnectionCount;
    private getClientIP;
    private trackActivity;
    private cleanupRateLimits;
    private startHeartbeat;
    private pingStaleConnections;
    notifyWorkflowUpdate(workflowId: string, update: any): void;
    notifyExecutionUpdate(executionId: string, update: any): void;
    getConnectedUsersCount(): number;
    getWorkflowSubscribers(workflowId: string): string[];
    getExecutionSubscribers(executionId: string): string[];
    getSecurityMetrics(): any;
    private calculateAverageConnectionDuration;
    shutdown(): void;
}
export declare const websocketSecurityService: WebSocketSecurityService;
export {};
//# sourceMappingURL=index.d.ts.map